<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Product â€“ 22 Celebration Co.</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
</head>

<body>
<header class="site-header">
  <div class="logo">
    <span class="logo-mark">22</span>
    <span class="logo-rule"></span>
    <span class="logo-text">Celebration Co.</span>
  </div>

  <nav class="main-nav">
    <a href="index.html">Home</a>
    <a href="about.html">About</a>
    <a href="store.html" class="active">Shop</a>
    <a href="contact.html">Contact</a>
  </nav>

  <div class="header-actions">
    <a href="tel:17708201456" class="btn-phone">(770) 820-1456</a>
    <a class="cart-link" href="cart.html" aria-label="Cart">
      <span class="cart-icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
          <path d="M6 6h15l-1.5 9h-11z"></path>
          <circle cx="9" cy="20" r="1.5"></circle>
          <circle cx="18" cy="20" r="1.5"></circle>
          <path d="M6 6l-1-3H2"></path>
        </svg>
      </span>
      <span class="cart-count" data-cart-count>0</span>
    </a>
  </div>
</header>

<main class="section">
  <div id="productDetail" class="product-detail">
    <div class="product-visual">
      <div class="product-image">Image coming soon</div>
      <div class="product-meta">
        <span id="productOccasions" class="meta-pill">Occasion</span>
        <span id="productAudience" class="meta-pill">Audience</span>
      </div>
    </div>

    <div class="product-info">
      <h1 id="productName" class="product-title">Gift Box</h1>
      <p id="productDescription" class="product-copy"></p>
      <div id="productPrice" class="product-price-lg"></div>

      <div class="product-actions">
        <a class="btn-secondary" href="store.html">Back to shop</a>
      </div>
    </div>
  </div>

  <section class="product-custom">
    <div class="custom-header">
      <p class="custom-kicker">Customization</p>
      <h2 class="section-title">Build your gift</h2>
      <p class="section-subtitle">Three quick steps. We will confirm pricing after checkout.</p>
    </div>

    <form class="custom-form" id="customForm">
      <div class="custom-step">
        <div class="step-label">
          <span class="step-pill">Step 1</span>
          <h3>Choose the essentials</h3>
        </div>
        <div class="custom-grid">
          <label>
            Gift size <span class="field-note">Required</span>
            <select name="size" required>
              <option value="standard">Standard</option>
              <option value="deluxe">Deluxe</option>
              <option value="luxe">Luxe</option>
            </select>
          </label>

          <label>
            Theme palette <span class="field-note">Required</span>
            <select name="palette" required>
              <option value="classic">Classic ivory + gold</option>
              <option value="modern">Modern neutral</option>
              <option value="bold">Bold color pop</option>
            </select>
          </label>

          <label>
            Event date <span class="field-note">Optional</span>
            <input type="date" name="eventDate" />
          </label>
        </div>
      </div>

      <div class="custom-step">
        <div class="step-label">
          <span class="step-pill">Step 2</span>
          <h3>Add extras</h3>
        </div>
        <div class="custom-addons">
          <label><input type="checkbox" name="addons" value="note" /> Handwritten note</label>
          <label><input type="checkbox" name="addons" value="candles" /> Scented candle</label>
          <label><input type="checkbox" name="addons" value="snacks" /> Gourmet snacks</label>
          <label><input type="checkbox" name="addons" value="balloons" /> Mini balloon bundle</label>
        </div>
      </div>

      <div class="custom-step">
        <div class="step-label">
          <span class="step-pill">Step 3</span>
          <h3>Personal message</h3>
        </div>
        <label class="custom-message">
          <textarea name="message" rows="5" placeholder="Tell us about the recipient, favorite colors, hobbies, or theme ideas."></textarea>
        </label>
      </div>
    </form>

    <div class="custom-footer">
      <div class="custom-tip">
        When you are done, add to cart and checkout.
      </div>
      <div class="custom-actions">
        <button id="addToCartBtn" class="btn-primary" type="button">Add to cart</button>
        <a class="btn-secondary" href="cart.html">View cart</a>
      </div>
      <p id="cartNotice" class="cart-notice"></p>
    </div>
  </section>
</main>

<footer class="site-footer">
  <p>&copy; <span id="year"></span> 22 Celebration Co.</p>
</footer>

<script src="products.js"></script>
<script src="cart.js"></script>
<script src="cart-count.js"></script>
<script>
  document.getElementById("year").textContent = new Date().getFullYear();

  const params = new URLSearchParams(window.location.search);
  const id = Number(params.get("id"));
  const product = products.find(p => p.id === id);

  const nameEl = document.getElementById("productName");
  const descEl = document.getElementById("productDescription");
  const priceEl = document.getElementById("productPrice");
  const occasionsEl = document.getElementById("productOccasions");
  const audienceEl = document.getElementById("productAudience");
  const addBtn = document.getElementById("addToCartBtn");
  const notice = document.getElementById("cartNotice");
  const form = document.getElementById("customForm");

  if (!product) {
    nameEl.textContent = "Product not found";
    descEl.textContent = "Please return to the shop and choose another gift.";
    priceEl.textContent = "";
    occasionsEl.textContent = "";
    audienceEl.textContent = "";
    addBtn.disabled = true;
  } else {
    nameEl.textContent = product.name;
    descEl.textContent = product.description;
    priceEl.textContent = `$${product.price.toFixed(2)}`;
    occasionsEl.textContent = product.occasions.join(", ");
    audienceEl.textContent = product.gender === "unisex" ? "All recipients" : product.gender;
  }

  function getFormValues() {
    const data = new FormData(form);
    const addons = data.getAll("addons");
    return {
      size: data.get("size"),
      palette: data.get("palette"),
      eventDate: data.get("eventDate"),
      addons,
      message: data.get("message")?.trim(),
    };
  }

  addBtn.addEventListener("click", () => {
    if (!product) return;
    const custom = getFormValues();
    const item = {
      cartItemId: `${product.id}-${Date.now()}`,
      id: product.id,
      name: product.name,
      price: product.price,
      quantity: 1,
      custom,
      customSummary: window.Cart.buildCustomizationSummary(custom),
    };

    window.Cart.addToCart(item);
    notice.textContent = "Added to cart. Next: open your cart and checkout.";
    if (window.CartCount) window.CartCount.update();
  });
</script>
</body>
</html>
